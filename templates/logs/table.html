<div class="card">
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead class="table-light">
                <tr>
                    <th style="width: 40px;"></th>
                    <th>Event</th>
                    <th>User</th>
                    <th>Application</th>
                    <th>IP Address</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for log in logs %}
                <tr>
                    <td>
                        {% if log.event_type == "s" || log.event_type == "ss" || log.event_type == "seacft" || log.event_type == "seccft" %}
                        <i class="bi bi-check-circle-fill text-success" title="Success"></i>
                        {% else if log.event_type == "f" || log.event_type == "fp" || log.event_type == "fu" || log.event_type == "fsa" %}
                        <i class="bi bi-x-circle-fill text-danger" title="Failed"></i>
                        {% else if log.event_type == "w" %}
                        <i class="bi bi-exclamation-triangle-fill text-warning" title="Warning"></i>
                        {% else %}
                        <i class="bi bi-info-circle text-info" title="{{ log.event_type }}"></i>
                        {% endif %}
                    </td>
                    <td>
                        <span class="fw-medium">{{ log.description.as_deref().unwrap_or(log.event_type.as_str()) }}</span>
                        <br>
                        <code class="small text-muted">{{ log.event_type }}</code>
                    </td>
                    <td>
                        {% match log.user_name %}
                        {% when Some with (user_name) %}
                        <a href="/users/{{ log.user_id.as_deref().unwrap_or("") }}">{{ user_name }}</a>
                        {% when None %}
                        {% match log.user_id %}
                        {% when Some with (user_id) %}
                        <a href="/users/{{ user_id }}"><code class="small">{{ user_id }}</code></a>
                        {% when None %}
                        <span class="text-muted">-</span>
                        {% endmatch %}
                        {% endmatch %}
                    </td>
                    <td>{{ log.client_name.as_deref().unwrap_or("-") }}</td>
                    <td>
                        {{ log.ip.as_deref().unwrap_or("-") }}
                        {% match log.location_info %}
                        {% when Some with (location) %}
                        {% match location.country_name %}
                        {% when Some with (country) %}
                        <br><small class="text-muted">{{ country }}</small>
                        {% when None %}
                        {% endmatch %}
                        {% when None %}
                        {% endmatch %}
                    </td>
                    <td><small>{{ log.date.as_deref().unwrap_or("-") }}</small></td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" class="text-center text-muted py-4">No logs found</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% if total_pages > 1 %}
<nav class="mt-3">
    <ul class="pagination justify-content-center">
        <li class="page-item {% if page == 0 %}disabled{% endif %}">
            <a class="page-link" hx-get="/logs?page={{ page - 1 }}" hx-target="#logs-table" hx-swap="innerHTML">Previous</a>
        </li>
        {% for p in 0..total_pages %}
        <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link" hx-get="/logs?page={{ p }}" hx-target="#logs-table" hx-swap="innerHTML">{{ p + 1 }}</a>
        </li>
        {% endfor %}
        <li class="page-item {% if page >= total_pages - 1 %}disabled{% endif %}">
            <a class="page-link" hx-get="/logs?page={{ page + 1 }}" hx-target="#logs-table" hx-swap="innerHTML">Next</a>
        </li>
    </ul>
</nav>
{% endif %}
